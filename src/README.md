# 📊 ESG報告書提取器 v1.0

專業提取ESG報告中的再生塑膠相關數據的智能工具。

## 🎯 主要功能

- **智能提取**：自動識別ESG報告中的再生塑膠相關數值和描述
- **批量處理**：支援多份報告同時處理
- **精確匹配**：採用先進的關鍵字與數值關聯性分析
- **智能彙整**：多公司多年度結果自動彙整分析
- **專業輸出**：生成格式化的Excel報表

## 🚀 快速開始

### 1. 環境準備

```bash
# 安裝依賴
pip install -r requirements.txt

# 設置API Key（在.env文件中）
GOOGLE_API_KEY=your_api_key_here
```

### 2. 準備數據

將ESG報告PDF文件放入 `data/` 目錄中

### 3. 執行提取

**互動模式（推薦）：**
```bash
python main.py
```

**命令行模式：**
```bash
# 自動執行完整流程
python main.py --auto

# 僅執行數據提取
python main.py --extract

# 僅執行彙整功能
python main.py --consolidate
```

## 📁 目錄結構

```
ESG報告書提取器/
├── main.py                 # 主程式
├── esg_extractor.py        # 核心提取模組
├── consolidator.py         # 彙整功能模組
├── preprocess.py           # 預處理模組
├── config.py              # 配置文件
├── api_manager.py         # API管理器
├── .env                   # 環境配置
├── requirements.txt       # 依賴包
├── data/                  # PDF輸入目錄
├── results/              # Excel輸出目錄
└── vector_db/           # 向量資料庫目錄
```

## 📊 輸出結果

### 個別公司結果
- **檔名格式**：`ESG提取結果_{公司名}_{年度}.xlsx`
- **內容包含**：
  - 提取結果：關鍵字、數值、信心分數、段落內容等
  - 統計摘要：關鍵字統計、平均信心分數等
  - 處理摘要：處理時間、文檔數量等

### 彙整報告
- **檔名**：`ESG彙整報告.xlsx`
- **內容包含**：
  - 按年度分組：2024年總覽、2023年總覽等
  - 按公司分組：每家公司的歷年資料
  - 彙整摘要：統計信息和處理詳情

## ⚙️ 核心特色

### 🎯 精確匹配
- 關鍵字與數值的精確關聯性分析
- 多層次相關性檢查
- 智能排除無關內容（職業災害、賽事等）

### 📄 智能去重
- 精確去重：相同內容只保留一份
- 頁面級去重：每頁最多保留2筆最佳結果
- 相似度去重：避免重複提取相似內容

### 🏢 公司名稱標準化
- 自動識別同一公司的不同命名方式
- 智能統一：「三芳」、「三芳化學」、「三芳化學工業」
- 保留原始名稱追踪

## 📋 提取範圍

### 🔍 主要關鍵字
- **再生塑膠類**：再生塑膠、再生料、PCR材料、rPET等
- **回收相關**：寶特瓶回收、塑膠循環、回收造粒等
- **循環經濟**：循環利用、廢料回收、材料回收等

### 📊 數據類型
- **數量數據**：億支、萬噸、千噸、噸/月等
- **比例數據**：百分比、使用率、減碳效益等
- **描述內容**：相關但無具體數值的重要描述

## ⚠️ 注意事項

1. **API Key設置**：必須在.env文件中設置有效的Google API Key
2. **PDF格式**：支援可搜索的PDF文件（掃描版需要OCR處理）
3. **處理時間**：根據報告大小，單份報告處理時間約1-5分鐘
4. **結果檢查**：建議人工檢查提取結果的準確性
5. **成本控制**：MAX_DOCS_PER_RUN參數可控制API使用成本

## 🔧 配置參數

### 關鍵配置（.env文件）
```bash
# API配置
GOOGLE_API_KEY=your_api_key_here
GEMINI_MODEL=gemini-1.5-flash

# 處理參數
MAX_DOCS_PER_RUN=300              # 最大處理文檔數
CONFIDENCE_THRESHOLD=0.6          # 信心分數閾值
ENABLE_LLM_ENHANCEMENT=true       # 是否啟用LLM增強
```

### 調優建議
- **提高精度**：提高 `CONFIDENCE_THRESHOLD` 到 0.7-0.8
- **提高覆蓋率**：降低 `CONFIDENCE_THRESHOLD` 到 0.5-0.6
- **控制成本**：降低 `MAX_DOCS_PER_RUN` 到 200-250

## 🛠️ 常見問題

### Q: 找不到任何結果怎麼辦？
A: 
1. 檢查該公司是否涉及再生塑膠業務
2. 嘗試降低信心分數閾值
3. 檢查PDF是否為可搜索格式

### Q: 結果太多且不準確？
A: 
1. 提高信心分數閾值
2. 檢查排除規則是否適當
3. 人工篩選結果

### Q: API調用失敗？
A: 
1. 檢查API Key是否正確設置
2. 確認網路連接正常
3. 檢查API使用額度

## 📞 技術支援

如遇到技術問題或需要客製化功能，請提供：
1. 錯誤訊息截圖
2. 問題PDF樣本
3. 期望的提取結果樣例

## 📝 更新記錄

### v1.0 (2024-12-19)
- 重新設計為專注的ESG報告書提取器
- 簡化系統架構，移除不必要功能
- 優化用戶界面，提供清晰的操作流程
- 加強關鍵字與數值的關聯性分析
- 完善彙整功能，支援多維度分析

---

📊 **ESG報告書提取器 v1.0** - 讓ESG數據提取變得簡單高效！